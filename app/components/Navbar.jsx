"use client";

import Link from "next/link";
import "./Navbar.scss";
import GoogleButton from "./GoogleButton";
import { signOut, useSession } from "next-auth/react";
import Image from "next/image";
import { UserIcon } from "@heroicons/react/outline";
import { LogoutIcon } from "@heroicons/react/outline";
import { useState } from "react";

export default function Navbar() {
  const { status, data: session } = useSession();
  const [isMenuActive, setIsMenuActive] = useState(false);

  const [isLoading, setIsLoading] = useState(false);

  const toggleMenu = () => {
    setIsMenuActive(!isMenuActive);
  }

  return (
    <nav className="navbar">
      <Link href={"/"}>
      <svg className="logo" width="395" height="95" viewBox="0 0 395 95" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M138.913 29.888C137.884 29.888 137.03 29.1059 136.877 28.0883C136.382 24.7865 135.433 21.7678 134.032 19.032C132.38 15.8066 130.099 13.25 127.188 11.362C124.277 9.39532 120.659 8.45132 116.332 8.52998C111.927 8.52998 108.426 9.74932 105.83 12.188C103.234 14.6266 101.936 17.5766 101.936 21.038C101.936 24.106 102.801 26.702 104.532 28.826C106.263 30.8713 108.583 32.72 111.494 34.372C114.483 36.024 117.827 37.676 121.524 39.328C124.513 40.5867 127.542 42.0026 130.61 43.576C133.678 45.1493 136.471 46.9586 138.988 49.004C141.505 50.9706 143.511 53.37 145.006 56.202C146.501 58.9553 147.248 62.22 147.248 65.996C147.248 70.4013 146.107 74.3346 143.826 77.796C141.545 81.2573 138.28 83.9713 134.032 85.938C129.863 87.9047 124.789 88.888 118.81 88.888C115.427 88.888 111.848 88.3766 108.072 87.354C105.475 86.6357 103.033 85.7039 100.747 84.5588C99.5786 83.9736 98.1515 84.8994 98.306 86.1969V86.1969C98.4166 87.1265 97.6906 87.944 96.7546 87.944H93.2799C92.1895 87.944 91.3001 87.0706 91.2802 85.9803L90.881 64.0203C90.8606 62.9017 91.7618 61.984 92.8806 61.984H94.6834C95.717 61.984 96.5731 62.7733 96.7225 63.7961C97.5921 69.7514 99.9592 74.3394 103.824 77.56C108.151 81.0213 113.303 82.752 119.282 82.752C122.271 82.752 124.985 82.2013 127.424 81.1C129.863 79.9986 131.79 78.4253 133.206 76.38C134.622 74.3346 135.33 71.9353 135.33 69.182C135.33 65.9567 134.347 63.2426 132.38 61.04C130.492 58.8373 128.053 56.9493 125.064 55.376C122.153 53.8026 119.085 52.308 115.86 50.892C112.635 49.476 109.488 47.9813 106.42 46.408C103.431 44.8346 100.717 43.0253 98.2779 40.98C95.8393 38.9347 93.9119 36.5353 92.4959 33.782C91.0799 30.95 90.3719 27.646 90.3719 23.87C90.3719 21.6673 90.7653 19.3466 91.5519 16.908C92.3386 14.4693 93.6759 12.1486 95.5639 9.94598C97.4519 7.74331 100.009 5.97331 103.234 4.63598C106.538 3.21998 110.668 2.51198 115.624 2.51198C118.613 2.51198 121.957 2.94465 125.654 3.80998C128.317 4.42036 130.805 5.36343 133.116 6.63919C134.25 7.26514 135.728 6.39707 135.605 5.10763V5.10763C135.521 4.22194 136.217 3.45598 137.107 3.45598H140.528C141.633 3.45598 142.528 4.35141 142.528 5.45598V27.888C142.528 28.9926 141.633 29.888 140.528 29.888H138.913Z" fill="white"/>
        <path d="M177.271 87.354C176.416 87.354 175.655 86.8098 175.379 86.0002L160.855 43.458C160.225 41.7273 159.714 40.3113 159.321 39.21C158.927 38.03 158.613 37.0466 158.377 36.26C158.312 36.021 158.249 35.7881 158.19 35.5611C157.942 34.6086 157.063 33.9452 156.081 34.0066L154.248 34.1212C153.096 34.1931 152.123 33.2787 152.123 32.1251V30C152.123 28.8954 153.018 28 154.123 28H176.201C177.305 28 178.201 28.8954 178.201 30V30.8874C178.201 31.9725 177.324 32.8206 176.265 33.057C174.319 33.4914 173.195 34.559 172.891 36.26C172.497 38.384 172.851 41.098 173.953 44.402L178.909 60.214C179.459 62.102 180.01 64.0293 180.561 65.996V65.996C181.059 67.7046 183.444 67.7282 183.953 66.0225C184.002 65.8568 184.051 65.6906 184.101 65.524C184.73 63.4 185.438 61.1187 186.225 58.68L195.575 29.3918C195.839 28.5627 196.61 28 197.48 28H202.123C202.987 28 203.753 28.5547 204.023 29.3755L214.663 61.748C215.213 63.4786 215.764 65.288 216.315 67.176C216.331 67.2229 216.347 67.2698 216.364 67.3167C216.918 68.9134 219.224 68.9046 219.737 67.294V67.294C220.366 65.5633 220.917 63.872 221.389 62.22L228.115 42.278C228.744 40.4687 229.295 38.8953 229.767 37.558C229.797 37.4815 229.827 37.4054 229.857 37.3298C230.467 35.8022 229.322 33.9429 227.681 34.0561L226.948 34.1066C225.792 34.1863 224.811 33.27 224.811 32.1113V30C224.811 28.8954 225.706 28 226.811 28H244.051C245.155 28 246.051 28.8954 246.051 30V30.9196C246.051 31.9918 245.2 32.8506 244.145 33.0433C243.077 33.2385 242.139 33.5633 241.331 34.018C240.072 34.6473 238.971 35.4733 238.027 36.496C237.161 37.44 236.453 38.5413 235.903 39.8C235.352 40.98 234.88 42.16 234.487 43.34L219.15 86.0302C218.865 86.8243 218.112 87.354 217.268 87.354H212.791C211.935 87.354 211.173 86.8086 210.898 85.9977L201.211 57.5C200.817 56.2413 200.385 54.904 199.913 53.488C199.441 51.9933 198.929 50.4593 198.379 48.886V48.886C197.991 47.5937 196.099 47.642 195.686 48.9265C195.603 49.186 195.517 49.4478 195.429 49.712C194.878 51.5213 194.327 53.2913 193.777 55.022C193.226 56.674 192.754 58.1293 192.361 59.388L183.265 86.0008C182.989 86.8101 182.228 87.354 181.373 87.354H177.271Z" fill="white"/>
        <path d="M251.209 84.044C251.209 82.9394 252.112 82.0785 253.2 81.8851C254.525 81.6495 255.513 81.1518 256.165 80.392C257.109 79.2906 257.659 77.7567 257.817 75.79C258.053 73.8233 258.171 71.542 258.171 68.946V44.52C258.171 43.1826 258.21 41.8453 258.289 40.508C258.327 39.8109 258.376 39.0947 258.433 38.3595C258.53 37.1329 257.53 36.0895 256.302 36.1573C255.681 36.1915 255.045 36.2257 254.395 36.26C253.702 36.26 253.034 36.2684 252.391 36.2854C251.238 36.3157 250.265 35.4027 250.265 34.2491V32.124C250.265 31.0194 251.161 30.1268 252.265 30.1058C254.873 30.0561 256.999 29.9048 258.643 29.652C260.767 29.2586 262.379 28.826 263.481 28.354C264.276 28.0358 264.929 27.6997 265.438 27.3458C265.874 27.0431 266.375 26.82 266.905 26.82H268.561C269.665 26.82 270.561 27.7154 270.561 28.82V72.368C270.561 73.784 270.521 75.2393 270.443 76.734C270.406 77.3954 270.361 78.0654 270.307 78.744C270.209 79.9778 271.215 81.0274 272.452 80.9985C272.923 80.9875 273.394 80.982 273.865 80.982C274.388 80.9512 274.893 80.9205 275.38 80.8897C276.538 80.8165 277.523 81.7333 277.523 82.8939V85C277.523 86.1046 276.627 87 275.523 87H253.209C252.104 87 251.209 86.1046 251.209 85V84.044ZM263.717 15.964C261.671 15.964 259.941 15.2166 258.525 13.722C257.109 12.1486 256.401 10.2606 256.401 8.05798C256.401 5.85531 257.148 4.00665 258.643 2.51198C260.137 0.938646 261.829 0.151978 263.717 0.151978C265.762 0.151978 267.453 0.938646 268.791 2.51198C270.207 4.00665 270.915 5.85531 270.915 8.05798C270.915 10.2606 270.207 12.1486 268.791 13.722C267.453 15.2166 265.762 15.964 263.717 15.964Z" fill="white"/>
        <path d="M309.7 88.888C307.733 88.888 305.727 88.6126 303.682 88.062C301.715 87.59 299.906 86.6067 298.254 85.112C296.602 83.5387 295.304 81.2967 294.36 78.386C293.416 75.4753 292.944 71.6206 292.944 66.822L293.165 36.6226C293.173 35.5124 292.275 34.608 291.165 34.608H286.448C285.343 34.608 284.448 33.7125 284.448 32.608V29.9273C284.448 28.8515 285.307 27.9856 286.355 27.7416C287.863 27.3904 289.391 26.6898 290.938 25.64C293.141 24.1453 295.068 22.1393 296.72 19.622C298.072 17.5614 299.082 15.369 299.749 13.0449C300.009 12.1397 300.814 11.48 301.756 11.48H303.688C304.792 11.48 305.688 12.3754 305.688 13.48V26C305.688 27.1046 306.583 28 307.688 28H321.86C322.964 28 323.86 28.8954 323.86 30V32.1618C323.86 33.2562 322.98 34.1474 321.886 34.1616L307.647 34.3465C306.559 34.3607 305.681 35.2428 305.673 36.3314L305.452 65.878C305.452 68.8673 305.688 71.5026 306.16 73.784C306.711 75.9866 307.576 77.7173 308.756 78.976C310.015 80.156 311.706 80.746 313.83 80.746C315.639 80.746 317.488 80.1953 319.376 79.094C320.837 78.2759 322.232 77.0672 323.563 75.4678C324.331 74.5453 325.715 74.3654 326.614 75.1594L327.607 76.035C328.364 76.7035 328.509 77.836 327.906 78.6469C326.36 80.7252 324.815 82.4082 323.27 83.696C321.382 85.2693 319.573 86.41 317.842 87.118C316.111 87.9046 314.538 88.3766 313.122 88.534C311.706 88.77 310.565 88.888 309.7 88.888Z" fill="white"/>
        <path d="M8.19515 67C13.6586 72.7662 20.3361 74 28.2277 74C36.1193 74 44.3401 72.7662 49.5 67C54.9634 60.9304 56 54.9975 56 46.5C56 38.0025 52.4634 31.7662 47 26C41.8401 19.9303 36.1193 16 28.2277 16C20.9431 16 13.9621 20.9303 8.19515 27C2.42821 32.7662 0 38.0025 0 46.5C0 54.9975 2.73174 60.9304 8.19515 67Z" fill="url(#paint0_radial_70_35)"/>
        <path d="M8.19515 67C13.6586 72.7662 20.3361 74 28.2277 74C36.1193 74 44.3401 72.7662 49.5 67C54.9634 60.9304 56 54.9975 56 46.5C56 38.0025 52.4634 31.7662 47 26C41.8401 19.9303 36.1193 16 28.2277 16C20.9431 16 13.9621 20.9303 8.19515 27C2.42821 32.7662 0 38.0025 0 46.5C0 54.9975 2.73174 60.9304 8.19515 67Z" fill="url(#paint1_radial_70_35)"/>
        <path d="M8.19515 67C13.6586 72.7662 20.3361 74 28.2277 74C36.1193 74 44.3401 72.7662 49.5 67C54.9634 60.9304 56 54.9975 56 46.5C56 38.0025 52.4634 31.7662 47 26C41.8401 19.9303 36.1193 16 28.2277 16C20.9431 16 13.9621 20.9303 8.19515 27C2.42821 32.7662 0 38.0025 0 46.5C0 54.9975 2.73174 60.9304 8.19515 67Z" fill="url(#paint2_radial_70_35)"/>
        <path d="M8.19515 67C13.6586 72.7662 20.3361 74 28.2277 74C36.1193 74 44.3401 72.7662 49.5 67C54.9634 60.9304 56 54.9975 56 46.5C56 38.0025 52.4634 31.7662 47 26C41.8401 19.9303 36.1193 16 28.2277 16C20.9431 16 13.9621 20.9303 8.19515 27C2.42821 32.7662 0 38.0025 0 46.5C0 54.9975 2.73174 60.9304 8.19515 67Z" fill="#DB00FF" fillOpacity="0.3"/>
        <path d="M369.11 87.8416C363.737 89.0476 358.626 88.905 353.776 87.4136C348.986 85.8283 344.854 83.047 341.382 79.0697C337.892 75.0156 335.449 69.88 334.053 63.6627C332.847 58.2897 332.908 52.9951 334.237 47.7788C335.642 42.5453 338.213 38.0175 341.951 34.1954C345.671 30.2966 350.41 27.7011 356.167 26.4088C359.391 25.6852 362.534 25.5035 365.598 25.8639C368.739 26.207 371.664 27.2033 374.372 28.8529C377.14 30.4084 379.555 32.7284 381.618 35.8127C383.383 38.4077 384.785 41.6545 385.822 45.5531C386.102 46.6074 385.44 47.6689 384.379 47.9264L348.748 56.58C347.688 56.8375 347.026 57.898 347.295 58.9554C348.418 63.3735 349.884 67.2509 351.692 70.5875C353.833 74.38 356.497 77.0876 359.683 78.7105C362.869 80.3334 366.612 80.6625 370.91 79.6976C372.982 79.2324 375.092 78.396 377.24 77.1883C379.447 75.8866 381.432 74.3123 383.194 72.4655C384.503 71.1386 385.607 69.7148 386.505 68.1942C387.093 67.1979 388.357 66.7666 389.375 67.317L390.215 67.7712C391.099 68.2494 391.497 69.3131 391.092 70.2332C389.655 73.4929 387.842 76.2703 385.652 78.5653C383.089 81.1562 380.32 83.1886 377.346 84.6626C374.465 86.1961 371.72 87.2558 369.11 87.8416ZM345.887 48.6047C345.881 49.8367 347.045 50.7087 348.247 50.4389L370.599 45.4214C371.677 45.1795 372.363 44.1065 372.047 43.0481C371.417 40.939 370.577 39.0691 369.527 37.4385C368.225 35.2313 366.575 33.6265 364.576 32.6239C362.577 31.6213 360.273 31.413 357.663 31.9988C353.595 32.9119 350.549 34.9663 348.525 38.1618C346.789 40.8144 345.91 44.2954 345.887 48.6047Z" fill="white"/>
        <path d="M369.11 87.8416C363.737 89.0476 358.626 88.905 353.776 87.4136C348.986 85.8283 344.854 83.047 341.382 79.0697C337.892 75.0156 335.449 69.88 334.053 63.6627C332.847 58.2897 332.908 52.9951 334.237 47.7788C335.642 42.5453 338.213 38.0175 341.951 34.1954C345.671 30.2966 350.41 27.7011 356.167 26.4088C359.391 25.6852 362.534 25.5035 365.598 25.8639C368.739 26.207 371.664 27.2033 374.372 28.8529C377.14 30.4084 379.555 32.7284 381.618 35.8127C383.383 38.4077 384.785 41.6545 385.822 45.5531C386.102 46.6074 385.44 47.6689 384.379 47.9264L348.748 56.58C347.688 56.8375 347.026 57.898 347.295 58.9554C348.418 63.3735 349.884 67.2509 351.692 70.5875C353.833 74.38 356.497 77.0876 359.683 78.7105C362.869 80.3334 366.612 80.6625 370.91 79.6976C372.982 79.2324 375.092 78.396 377.24 77.1883C379.447 75.8866 381.432 74.3123 383.194 72.4655C384.503 71.1386 385.607 69.7148 386.505 68.1942C387.093 67.1979 388.357 66.7666 389.375 67.317L390.215 67.7712C391.099 68.2494 391.497 69.3131 391.092 70.2332C389.655 73.4929 387.842 76.2703 385.652 78.5653C383.089 81.1562 380.32 83.1886 377.346 84.6626C374.465 86.1961 371.72 87.2558 369.11 87.8416ZM345.887 48.6047C345.881 49.8367 347.045 50.7087 348.247 50.4389L370.599 45.4214C371.677 45.1795 372.363 44.1065 372.047 43.0481C371.417 40.939 370.577 39.0691 369.527 37.4385C368.225 35.2313 366.575 33.6265 364.576 32.6239C362.577 31.6213 360.273 31.413 357.663 31.9988C353.595 32.9119 350.549 34.9663 348.525 38.1618C346.789 40.8144 345.91 44.2954 345.887 48.6047Z" fill="white"/>
        <defs>
        <radialGradient id="paint0_radial_70_35" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(10.64 33.11) rotate(66.9962) scale(44.4225 43.367)">
        <stop stopColor="#CC00FF"/>
        <stop offset="1" stopColor="#CC00FF" stopOpacity="0"/>
        </radialGradient>
        <radialGradient id="paint1_radial_70_35" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(47.6 27.89) rotate(135.911) scale(66.2713 66.3861)">
        <stop stopColor="#4200FF"/>
        <stop offset="1" stopColor="#4200FF" stopOpacity="0"/>
        </radialGradient>
        <radialGradient id="paint2_radial_70_35" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(56.56 85.89) rotate(-90.4591) scale(69.8922 77.0412)">
        <stop stopColor="#FF9900"/>
        <stop offset="1" stopColor="#FF9900" stopOpacity="0"/>
        </radialGradient>
        </defs>
      </svg>
      </Link>
      {status === "authenticated" ? (
        <div className="menu">
          <div className="pp-wrapper" onClick={toggleMenu}>
            {session.user.image ? (
              <Image
                src={session.user.image}
                alt="profile"
                width={128}
                height={128}
              />
            ) : (
              <UserIcon className="regular-icon white-icon"/>
            )}
          </div>
          <div className={`menu-bg ${isMenuActive ? "active" : ""}`} onClick={toggleMenu}></div>
          <div className={`menu-items ${isMenuActive ? "active" : ""}`}>
            <div className="menu-item" id="user-info">
              <div className="pp-wrapper">
                <Image
                  src={session.user.image}
                alt="profile"
                  width={128}
                  height={128}
                />
              </div>
              <span className="text-white text-regular">{session.user.name}</span>
              <span className="text-grey text-small">{session.user.email}</span>
            </div>
            <div className="menu-item">
              <button onClick={()=>signOut()} className="button secondary">
                <LogoutIcon className="regular-icon white-icon"/>
                <span>Se déconnecter</span>
              </button>
            </div>
            <button className="toggle-menu" onClick={toggleMenu}>
              Annuler
            </button>
          </div>
        </div>
      ) : (
        status === "loading" ? <div className="blank-button"></div> : <GoogleButton />
      )}
    </nav>
  );
}
